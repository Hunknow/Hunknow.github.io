<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>注册测试</title>
    <style>
        body { font-family: Arial; padding: 50px; }
        .input { width: 100%; padding: 10px; margin: 10px 0; }
        .btn { padding: 10px 20px; background: green; color: white; border: none; cursor: pointer; }
        .error { color: red; }
        .success { color: green; }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.7/dist/umd/supabase.min.js"></script>
</head>
<body>
    <h1>注册测试（无RLS）</h1>
    <input type="text" id="phone" class="input" placeholder="手机号: 13812345678">
    <input type="text" id="name" class="input" placeholder="用户名: 测试用户">
    <input type="password" id="pwd" class="input" placeholder="密码: 12345678">
    <button class="btn" onclick="register()">注册</button>
    <div id="msg"></div>
    
    <script>
        const supabase = window.supabase.createClient(
            'https://pnakeholshmrtwctzqcb.supabase.co',
            'sb_publishable_tVf76wqdUIvhiNUymxKHEA_FAMmDvf3'
        );
        
        async function register() {
            const phone = document.getElementById('phone').value;
            const name = document.getElementById('name').value;
            const pwd = document.getElementById('pwd').value;
            
            const { data, error } = await supabase.from('users').insert({
                phone, name, password_hash: pwd, is_admin: false
            }).select().single();
            
            if (error) {
                document.getElementById('msg').innerHTML = `<p class="error">失败: ${error.message}</p>`;
            } else {
                document.getElementById('msg').innerHTML = `<p class="success">成功！</p>`;
            }
        }
    </script>
</body>
</html>
